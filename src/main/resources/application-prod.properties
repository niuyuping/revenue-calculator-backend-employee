# Production environment configuration
spring.profiles.active=prod

# Production environment logging configuration
logging.level.root=WARN
logging.level.jp.asatex.revenue_calculator_backend_employee=INFO
logging.level.org.springframework.web.reactive=WARN
logging.level.org.springframework.r2dbc=WARN
logging.level.io.r2dbc.postgresql=WARN
logging.level.org.flywaydb=WARN
logging.level.org.springdoc=WARN

# Production environment uses JSON format logging
logging.pattern.console={"timestamp":"%d{yyyy-MM-dd HH:mm:ss.SSS}","level":"%-5level","thread":"%thread","logger":"%logger{36}","message":"%msg","traceId":"%X{traceId:-}","spanId":"%X{spanId:-}","service":"revenue-calculator-employee"}%n

# Production environment log file configuration
logging.file.name=/var/log/revenue-calculator/employee.log
logging.logback.rollingpolicy.max-file-size=500MB
logging.logback.rollingpolicy.max-history=60
logging.logback.rollingpolicy.total-size-cap=10GB

# Production environment database configuration (Google Cloud SQL with IAM)
# 使用Google Cloud SQL Proxy + IAM身份验证，无需密码
spring.r2dbc.url=${DB_URL:r2dbc:postgresql://localhost:5432/asatex-revenue?sslmode=disable}
spring.r2dbc.username=${DB_USERNAME:db_user}
# 使用IAM身份验证，无需密码
spring.r2dbc.password=
spring.r2dbc.pool.max-size=${DB_POOL_MAX_SIZE:20}
spring.r2dbc.pool.max-idle-time=${DB_POOL_MAX_IDLE_TIME:PT30M}
spring.r2dbc.pool.max-life-time=${DB_POOL_MAX_LIFE_TIME:PT1H}

# Production environment Flyway configuration
spring.flyway.url=${DB_URL:jdbc:postgresql://localhost:5432/asatex-revenue?sslmode=disable}
spring.flyway.user=${DB_USERNAME:db_user}
# 使用IAM身份验证，无需密码
spring.flyway.password=

# Production environment server configuration
server.port=${SERVER_PORT:9001}

# Production environment Actuator configuration
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=never

# Google Cloud SQL Proxy configuration
# 连接名称: gen-lang-client-0889947961:asia-northeast1:asatex-revenue-calculator-database
# 数据库名称: asatex-revenue
# 用户名: db_user

# Redis configuration for production (if using Cloud Memorystore)
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.database=${REDIS_DATABASE:0}
spring.data.redis.timeout=${REDIS_TIMEOUT:2000ms}
spring.data.redis.lettuce.pool.max-active=${REDIS_POOL_MAX_ACTIVE:8}
spring.data.redis.lettuce.pool.max-idle=${REDIS_POOL_MAX_IDLE:8}
spring.data.redis.lettuce.pool.min-idle=${REDIS_POOL_MIN_IDLE:0}

# Cache configuration for production
spring.cache.type=redis
spring.cache.redis.time-to-live=${CACHE_TTL:1800000}
spring.cache.redis.cache-null-values=false

